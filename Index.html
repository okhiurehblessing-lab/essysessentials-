<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Essys Essentials</title>
<style>
  :root {
    --main-color: #2a9d8f;
    --accent-color: #e76f51;
    --bg-color: #f4f4f4;
    --text-color: #333;
    --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  body {
    margin: 0; background: var(--bg-color); font-family: var(--font-family); color: var(--text-color);
  }
  header, footer {
    background: var(--main-color); color: white; padding: 1rem; text-align: center;
  }
  .logo {
    height: 50px; vertical-align: middle;
  }
  main {
    max-width: 900px; margin: auto; padding: 1rem;
  }
  button {
    background: var(--accent-color); border: none; color: white; padding: 0.5rem 1rem; cursor: pointer; border-radius: 4px;
  }
  button:hover {
    background: #d45a39;
  }
  .product-grid {
    display: grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap: 1rem;
  }
  .product-card {
    background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .product-card img {
    width: 100%; height: 150px; object-fit: contain; border-radius: 4px;
  }
  .cart {
    position: fixed; top: 1rem; right: 1rem; background: var(--accent-color); color: white; padding: 0.5rem 1rem; border-radius: 50%;
    font-weight: bold; cursor: pointer;
  }
  .hidden { display: none; }
  #adminPanel {
    background: white; padding: 1rem; max-width: 600px; margin: 1rem auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }
  #adminPanel input, #adminPanel textarea, #adminPanel select {
    width: 100%; margin-bottom: 0.5rem; padding: 0.4rem; border-radius: 4px; border: 1px solid #ccc;
  }
  #customization {
    margin-top: 1rem;
    border-top: 1px solid #ddd;
    padding-top: 1rem;
  }
  #messageBox {
    margin-top: 1rem;
    padding: 0.5rem; background: #eee; border-radius: 4px;
  }
  #whatsappContact {
    position: fixed; bottom: 1rem; right: 1rem; background: #25D366; color: white; padding: 0.75rem 1rem; border-radius: 50px; font-weight: bold;
    text-decoration: none;
  }
  nav {
    margin-bottom: 1rem; text-align: right;
  }
  nav button {
    margin-left: 0.5rem;
  }
  .pagination {
    margin-top: 1rem; text-align: center;
  }
  .pagination button {
    margin: 0 0.25rem;
  }
</style>
</head>
<body>

<header>
  <img src="" alt="Logo" id="siteLogo" class="logo" />
  <h1>Essys Essentials</h1>
  <nav>
    <button id="adminLoginBtn">Admin Login</button>
    <button id="adminLogoutBtn" class="hidden">Logout Admin</button>
    <button id="viewCartBtn">Cart (<span id="cartCount">0</span>)</button>
  </nav>
</header>

<main id="customerView">

  <div id="productGrid" class="product-grid"></div>

  <div class="pagination" id="pagination"></div>

  <div id="messageBox"></div>

  <div id="checkoutSection" class="hidden">
    <h2>Checkout</h2>
    <p>Bank Transfer Info:</p>
    <p id="bankDetails"></p>
    <p>Or pay with card (mock payment):</p>
    <button id="mockPayBtn">Pay with Card</button>
    <button id="backToShopBtn">Back to Shop</button>
  </div>

</main>

<div id="adminPanel" class="hidden">
  <h2>Admin Panel</h2>
  <label>Upload Product Image:</label>
  <input type="file" id="productImageInput" accept="image/*" />
  <label>Product Name:</label>
  <input type="text" id="productNameInput" />
  <label>Product Description:</label>
  <textarea id="productDescInput"></textarea>
  <label>Product Price (₦):</label>
  <input type="number" id="productPriceInput" min="0" />
  <button id="addProductBtn">Add Product</button>

  <hr />

  <h3>Customize Website</h3>
  <label>Business Logo:</label>
  <input type="file" id="logoUpload" accept="image/*" />
  <label>Main Color:</label>
  <input type="color" id="colorPickerMain" value="#2a9d8f" />
  <label>Accent Color:</label>
  <input type="color" id="colorPickerAccent" value="#e76f51" />
  <label>Background Color:</label>
  <input type="color" id="colorPickerBg" value="#f4f4f4" />
  <label>Font Color:</label>
  <input type="color" id="colorPickerText" value="#333333" />
  <button id="saveCustomizationBtn">Save Customization</button>

  <hr />

  <h3>Business Info</h3>
  <label>WhatsApp Number (include country code, e.g. +2348012345678):</label>
  <input type="text" id="whatsappInput" placeholder="+234..." />
  <label>Bank Account Details:</label>
  <textarea id="bankInput" placeholder="Bank name, Account number, Account name..."></textarea>

  <hr />

  <h3>Custom Message for Customers</h3>
  <textarea id="customMessageInput" placeholder="Write a message to customers here..."></textarea>
  <button id="saveMessageBtn">Save Message</button>
</div>

<!-- Admin Login Modal -->
<div id="adminLoginModal" class="hidden" style="position: fixed; top:0; left:0; width:100vw; height:100vh; background: rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center;">
  <div style="background:white; padding: 2rem; border-radius: 8px; max-width: 300px; width: 90%;">
    <h2>Admin Login</h2>
    <input type="password" id="adminPassword" placeholder="Enter password" style="width: 100%; padding: 0.5rem; margin-bottom: 1rem;" />
    <button id="adminLoginSubmitBtn">Login</button>
    <button id="adminLoginCancelBtn" style="margin-left: 1rem;">Cancel</button>
    <p id="loginError" style="color: red;"></p>
  </div>
</div>

<a href="#" id="whatsappContact" target="_blank" class="hidden">WhatsApp Us</a>

<script>
  let products = JSON.parse(localStorage.getItem('ee_products')) || [];
  let customization = JSON.parse(localStorage.getItem('ee_customization')) || {
    mainColor: '#2a9d8f',
    accentColor: '#e76f51',
    bgColor: '#f4f4f4',
    textColor: '#333333',
    logoDataUrl: '',
    whatsapp: '',
    bankDetails: '',
    customMessage: '',
  };
  let cart = JSON.parse(localStorage.getItem('ee_cart')) || [];
  let adminLoggedIn = false;
  const adminPassword = 'admin123';

  const adminLoginBtn = document.getElementById('adminLoginBtn');
  const adminLogoutBtn = document.getElementById('adminLogoutBtn');
  const adminLoginModal = document.getElementById('adminLoginModal');
  const adminLoginSubmitBtn = document.getElementById('adminLoginSubmitBtn');
  const adminLoginCancelBtn = document.getElementById('adminLoginCancelBtn');
  const adminPasswordInput = document.getElementById('adminPassword');
  const loginError = document.getElementById('loginError');
  const adminPanel = document.getElementById('adminPanel');
  const customerView = document.getElementById('customerView');
  const productGrid = document.getElementById('productGrid');
  const addProductBtn = document.getElementById('addProductBtn');
  const productImageInput = document.getElementById('productImageInput');
  const productNameInput = document.getElementById('productNameInput');
  const productDescInput = document.getElementById('productDescInput');
  const productPriceInput = document.getElementById('productPriceInput');
  const logoUpload = document.getElementById('logoUpload');
  const colorPickerMain = document.getElementById('colorPickerMain');
  const colorPickerAccent = document.getElementById('colorPickerAccent');
  const colorPickerBg = document.getElementById('colorPickerBg');
  const colorPickerText = document.getElementById('colorPickerText');
  const saveCustomizationBtn = document.getElementById('saveCustomizationBtn');
  const siteLogo = document.getElementById('siteLogo');
  const whatsappInput = document.getElementById('whatsappInput');
  const whatsappContact = document.getElementById('whatsappContact');
  const bankInput = document.getElementById('bankInput');
  const bankDetailsDisplay = document.getElementById('bankDetails');
  const customMessageInput = document.getElementById('customMessageInput');
  const saveMessageBtn = document.getElementById('saveMessageBtn');
  const cartCount = document.getElementById('cartCount');
  const viewCartBtn = document.getElementById('viewCartBtn');
  const checkoutSection = document.getElementById('checkoutSection');
  const mockPayBtn = document.getElementById('mockPayBtn');
  const backToShopBtn = document.getElementById('backToShopBtn');
  const paginationDiv = document.getElementById('pagination');

  const productsPerPage = 6;
  let currentPage = 1;

  function saveData() {
    localStorage.setItem('ee_products', JSON.stringify(products));
    localStorage.setItem('ee_customization', JSON.stringify(customization));
    localStorage.setItem('ee_cart', JSON.stringify(cart));
  }

  function renderProducts() {
    productGrid.innerHTML = '';
    if(products.length === 0){
      productGrid.innerHTML = '<p>No products available.</p>';
      paginationDiv.innerHTML = '';
      return;
    }
    const start = (currentPage - 1) * productsPerPage;
    const end = start + productsPerPage;
    const pageProducts = products.slice(start, end);

    pageProducts.forEach((p, idx) => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
        <img src="${p.image}" alt="${p.name}" />
        <h3>${p.name}</h3>
        <p>${p.description}</p>
        <p><strong>₦${p.price.toFixed(2)}</strong></p>
        <button data-index="${start + idx}">Add to Cart</button>
      `;
      productGrid.appendChild(card);
    });

    const totalPages = Math.ceil(products.length / productsPerPage);
    paginationDiv.innerHTML = '';
    if(totalPages > 1){
      for(let i = 1; i <= totalPages; i++){
        const btn = document.createElement('button');
        btn.textContent = i;
        if(i === currentPage) btn.disabled = true;
        btn.addEventListener('click', () => {
          currentPage = i;
          renderProducts();
        });
        paginationDiv.appendChild(btn);
      }
    }
  }

  function updateCartCount() {
    cartCount.textContent = cart.length;
  }

  function addToCart(index) {
    cart.push(products[index]);
    updateCartCount();
    saveData();
    alert('Product added to cart!');
  }

  function showCheckout() {
    customerView.innerHTML = '';
    checkoutSection.classList.remove('hidden');
    bankDetailsDisplay.textContent = customization.bankDetails || 'No bank details provided.';
  }

  function hideCheckout() {
    checkoutSection.classList.add('hidden');
    customerView.innerHTML = '';
    customerView.appendChild(productGrid);
    customerView.appendChild(paginationDiv);
    customerView.appendChild(document.getElementById('messageBox'));
  }

  function updateCustomizationUI() {
    colorPickerMain.value = customization.mainColor;
    colorPickerAccent.value = customization.accentColor;
    colorPickerBg.value = customization.bgColor;
    colorPickerText.value = customization.textColor;
    siteLogo.src = customization.logoDataUrl || '';
    whatsappInput.value = customization.whatsapp;
    bankInput.value = customization.bankDetails;
    customMessageInput.value = customization.customMessage;
    updateThemeColors();
    updateWhatsAppContact();
    renderMessage();
  }

  function updateThemeColors() {
    document.documentElement.style.setProperty('--main-color', customization.mainColor);
    document.documentElement.style.setProperty('--accent-color', customization.accentColor);
    document.documentElement.style.setProperty('--bg-color', customization.bgColor);
    document.documentElement.style.setProperty('--text-color', customization.textColor);
  }

  function updateWhatsAppContact() {
    if(customization.whatsapp){
      const cleanNum = customization.whatsapp.replace(/\D/g,'');
      whatsappContact.href = `https://wa.me/${cleanNum}`;
      whatsappContact.classList.remove('hidden');
    } else {
      whatsappContact.classList.add('hidden');
    }
  }

  function renderMessage() {
    const messageBox = document.getElementById('messageBox');
    messageBox.textContent = customization.customMessage;
  }

  adminLoginBtn.addEventListener('click', () => {
    adminLoginModal.classList.remove('hidden');
    adminPasswordInput.value = '';
    loginError.textContent = '';
  });

  adminLoginCancelBtn.addEventListener('click', () => {
    adminLoginModal.classList.add('hidden');
  });

  adminLoginSubmitBtn.addEventListener('click', () => {
    const enteredPassword = adminPasswordInput.value.trim();
    if (enteredPassword === adminPassword) {
      adminLoggedIn = true;
      adminLoginModal.classList.add('hidden');
      adminLoginBtn.classList.add('hidden');
      adminLogoutBtn.classList.remove('hidden');
      adminPanel.classList.remove('hidden');
      updateCustomizationUI();
      renderProducts();
      updateCartCount();
    } else {
      loginError.textContent = 'Incorrect password!';
    }
  });

  adminLogoutBtn.addEventListener('click', () => {
    adminLoggedIn = false;
    adminLoginBtn.classList.remove('hidden');
    adminLogoutBtn.classList.add('hidden');
    adminPanel.classList.add('hidden');
    renderProducts();
    updateCartCount();
  });

  addProductBtn.addEventListener('click', () => {
    const name = productNameInput.value.trim();
    const desc = productDescInput.value.trim();
    const price = parseFloat(productPriceInput.value);
    if(!name || !desc || isNaN(price) || price < 0){
      alert('Please fill all product details correctly.');
      return;
    }
    if(productImageInput.files.length === 0){
      alert('Please select a product image.');
      return;
    }
    const reader = new FileReader();
    reader.onload = function(e){
      products.push({
        name,
        description: desc,
        price,
        image: e.target.result,
      });
      saveData();
      renderProducts();
      productNameInput.value = '';
      productDescInput.value = '';
      productPriceInput.value = '';
      productImageInput.value = '';
      alert('Product added!');
    }
    reader.readAsDataURL(productImageInput.files[0]);
  });

  saveCustomizationBtn.addEventListener('click', () => {
    customization.mainColor = colorPickerMain.value;
    customization.accentColor = colorPickerAccent.value;
    customization.bgColor = colorPickerBg.value;
    customization.textColor = colorPickerText.value;
    if(logoUpload.files.length > 0){
      const reader = new FileReader();
      reader.onload = function(e){
        customization.logoDataUrl = e.target.result;
        siteLogo.src = customization.logoDataUrl;
        saveData();
      }
      reader.readAsDataURL(logoUpload.files[0]);
    }
    customization.whatsapp = whatsappInput.value.trim();
    customization.bankDetails = bankInput.value.trim();
    saveData();
    updateThemeColors();
    updateWhatsAppContact();
    alert('Customization saved!');
  });

  saveMessageBtn.addEventListener('click', () => {
    customization.customMessage = customMessageInput.value.trim();
    saveData();
    renderMessage();
    alert('Message saved!');
  });

  productGrid.addEventListener('click', e => {
    if(e.target.tagName === 'BUTTON'){
      const index = parseInt(e.target.getAttribute('data-index'));
      addToCart(index);
    }
  });

  viewCartBtn.addEventListener('click', () => {
    if(cart.length === 0){
      alert('Cart is empty!');
      return;
    }
    showCheckout();
  });

  mockPayBtn.addEventListener('click', () => {
    alert('Thank you for your payment! Your order has been received.');
    cart = [];
    updateCartCount();
    saveData();
    hideCheckout();
  });

  backToShopBtn.addEventListener('click', () => {
    hideCheckout();
  });

  function init() {
    updateThemeColors();
    updateWhatsAppContact();
    siteLogo.src = customization.logoDataUrl || '';
    renderProducts();
    renderMessage();
    updateCartCount();
  }

  init();
</script>

</body>
</html>
